!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.lscache=b()}(this,function(){function a(){try{return sessionStorage?sessionStorage:void 0}catch(a){return}}function b(){try{return localStorage?localStorage:void 0}catch(a){return}}function c(){try{return chrome&&chrome.storage&&chrome.storage.sync?chrome.storage.sync:void 0}catch(a){return}}function d(d){if(void 0!==s)return s;switch(d){case"session":r=a(),void 0===r&&(d="local",r=b());break;case"sync":r=c(),void 0===r&&(d="local",r=b());break;default:d="local",r=b()}q=d;try{var f="__lscachetest__",g=f;k(f,g),l(f),s=!0}catch(a){e(a)&&r.length?s=!0:(s=!1,r=void 0)}return s}function e(a){return a&&("QUOTA_EXCEEDED_ERR"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name||"QuotaExceededError"===a.name)}function f(){return void 0===t&&(t=null!=window.JSON),t}function g(a){return a.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")}function h(a){return a+v}function i(){return(new Date).getTime()/x}function j(a){return r.getItem(u+z+a)}function k(a,b){r.removeItem(u+z+a),r.setItem(u+z+a,b)}function l(a){r.removeItem(u+z+a)}function m(a){for(var b=new RegExp("^"+u+g(z)+"(.*)"),c=r.length-1;c>=0;--c){var d=r.key(c);d=d&&d.match(b),d=d&&d[1],d&&d.indexOf(v)<0&&a(d,h(d))}}function n(a){var b=h(a);l(a),l(b)}function o(a){var b=h(a),c=j(b);if(c){var d=parseFloat(c);if(i()>=d)return l(a),l(b),!0}}function p(a,b){A&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+a),b&&window.console.warn("lscache - The error was: "+b.message))}var q,r,s,t,u="lscache-",v="-cacheexpiration",w=10,x=6e4,y=Math.floor(864e13/x),z="",A=!1,B={init:function(a){var b={};return a instanceof Object&&Object.keys(a).forEach(function(c){switch(c){case"storageType":s=void 0;var e=d(a[c]);b.supported=e,b.usingStorageType=q;break;default:throw new Error("Unknown property",c,a[c])}}),b},set:function(a,b,c){if(d()&&f()){try{b=JSON.stringify(b)}catch(a){return}try{k(a,b)}catch(c){if(!e(c))return void p("Could not add item with key '"+a+"'",c);var g,o=[];m(function(a,b){var c=j(b);c=c?parseFloat(c):y,o.push({key:a,size:(j(a)||"").length,expiration:c})}),o.sort(function(a,b){return b.expiration-a.expiration});for(var q=(b||"").length;o.length&&q>0;)g=o.pop(),p("Cache is full, removing item with key '"+a+"'"),n(g.key),q-=g.size;try{k(a,b)}catch(b){return void p("Could not add item with key '"+a+"', perhaps it's too big?",b)}}c?k(h(a),(i()+c).toString(w)):l(h(a))}},get:function(a){if(!d())return null;if(o(a))return null;var b=j(a);if(!b||!f())return b;try{return JSON.parse(b)}catch(a){return b}},remove:function(a){d()&&n(a)},supported:function(){return d()},flush:function(){d()&&m(function(a){n(a)})},flushExpired:function(){d()&&m(function(a){o(a)})},setBucket:function(a){z=a},resetBucket:function(){z=""},enableWarnings:function(a){A=a}};return B});